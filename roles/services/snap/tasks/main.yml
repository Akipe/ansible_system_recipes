---
- name: Install snapd
  become: yes
  become_user: ansible_aur
  aur:
    use: yay
    skip_installed: true
    aur_only: yes
    name: snapd

- name: Start and enable snapd with AppArmor
  systemd:
    name: snapd.apparmor.service
    enabled: yes
    state: started

- name: Start and enable snapd
  systemd:
    name: snapd.socket
    enabled: yes
    state: started

- name: Create /snap symlink for old-style snaps
  become: true
  file:
    src: /var/lib/snapd/snap
    dest: /snap
    state: link
