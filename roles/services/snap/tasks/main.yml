---

- name: Include tasks for all Archlinux based distributions
  include_tasks: archlinux_common/main.yml
  when: ansible_distribution == "Archlinux"
    
- name: Include tasks for Archlinux
  include_tasks: archlinux/main.yml
  when: ansible_lsb.id == "Archlinux"

- name: Include tasks for Manjaro
  include_tasks: manjaro/main.yml
  when: ansible_lsb.id == "ManjaroLinux"

# - name: Start and enable snapd with AppArmor
#   systemd:
#     name: snapd.apparmor.service
#     enabled: yes
#     state: started

- name: Start and enable snapd
  systemd:
    name: snapd.socket
    enabled: yes
    state: started

- name: Create /snap symlink for old-style snaps
  become: true
  file:
    src: /var/lib/snapd/snap
    dest: /snap
    state: link
